{"version":3,"sources":["gameScene.js"],"names":["com","require","cc","Class","extends","Component","properties","canvas","Node","HeroPrefab","default","type","Prefab","testSprite","heroSprite","leftBodyNode","rightBodyNode","cameraNode","bodyPrefab","onLoad","winSize","director","getWinSize","window","revivePropNum","isShowRevive","Global_isResurgenced","Global_isCrashWithSquare","Global_isTurnRightCrash","Global_isTurnLeftCrash","Global_speed","self","beforHeroPosition","p","Global_scene","heroPosY","height","Global_createrSomethingY","Global_suqareWidth","heroDead","initHero","moveHero","positionY","Hero","width","level","touchMoveHeroPodY","callBackTrue","timer","physicsManager","getPhysicsManager","enabled","enabledContactListener","stopActions","flagNode","startGame","disX","touchFlag","prePosX","start","Global_thisNode","flagCount","bodyIndex","onGotBodyReward","count","getComponent","setHeroLength","onAddBodyToLast","instantiate","init","parent","setLocalZOrder","setPosition","active","getPosition","onTouchCallBack","onRecoveryRotation","onSetHeroSpeed","v2","Global_VelocityForY","on","EventType","TOUCH_START","event","Global_moveTouchPosition","push","target","convertTouchToNodeSpaceAR","touch","x","getScheduler","isScheduled","schedule","node","TOUCH_MOVE","s","Global_heroMoving","length","Math","abs","Global_tttt","shift","flagDisX","multiple","adsControl","canUseSdkbox","winSizeWidth","myNative","callNativeFun","floor","distance","y","velocity","normalizeSelf","mulSelf","TOUCH_END","i","unschedule","onSetPosition","pos","isRightToLeft","canMovePosition","convertToNodeSpaceAR","onSetHeroPosition","num","setPositionX","getPositionX","onGetHeroPosition","Global_heroBodyArr","len","Global_heroLength","onAddBodyFromPool","bodyLastPosition","Global_heroPositionsArray","Global_oldHeroLength","index","body","onSetPreBodyIndex","shareForIntensify","shareForDie","noToShare","Global_createPositionY","isAgain","startFlag","lateUpdate","dt","getPositionY","Global_VelocityXNUM","shareForCrash","getCrashSpeed","update"],"mappings":"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","file":"gameScene.js","sourceRoot":"..\\..\\..\\..\\assets\\Script","sourcesContent":["\nvar com = require('common');\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        canvas: cc.Node,\n        HeroPrefab:{\n            default:null,\n            type: cc.Prefab\n        },      \n        testSprite: cc.Node,\n        heroSprite: cc.Node,\n        leftBodyNode: cc.Node,\n        rightBodyNode: cc.Node,  \n        cameraNode:{\n            default: null,\n            type: cc.Node\n        },\n         //身体预制资源\n         bodyPrefab:{\n            default: null,\n            type: cc.Prefab\n        },\n    },\n    onLoad: function() {       \n        this.winSize = cc.director.getWinSize();\n      \n        //全局变量控制主场景的action\n        window.revivePropNum = 0;\n        window.isShowRevive = false;\n        window.Global_isResurgenced = false;\n        window.Global_isCrashWithSquare = false;\n        window.Global_isTurnRightCrash = false;\n        window.Global_isTurnLeftCrash = false;\n        window.Global_speed = 4;\n\n        var self = this;\n\n\n\n        self.beforHeroPosition = cc.p(0,0);//用判断身体游动\n\n\n        //初始化全局变量\n        window.Global_scene = this;\n        self.heroPosY = cc.director.getWinSize().height/7;//头节点应处的位置\n        window.Global_createrSomethingY = cc.director.getWinSize().height/2 + window.Global_suqareWidth*0.5;\n        \n        //Hero相关数据\n        self.heroDead = false;\n        //初始化hero\n        self.initHero();\n        //移动hero\n        self.moveHero(self);\n        self.positionY = cc.director.getWinSize().height/2 - 4*this.heroPosY - this.Hero.width/2;\n\n        //速度等级\n        self.level = 1;\n        //点击移动时候的hero的y坐标\n        self.touchMoveHeroPodY = 0;\n        //\n        self.callBackTrue = 0;\n        self.timer = 5;\n        \n        \n        \n        //刚体的碰撞\n        self.physicsManager = cc.director.getPhysicsManager();\n        self.physicsManager.enabled = true;\n        self.physicsManager.enabledContactListener = true;\n        self.physicsManager.enabled = true;\n\n        self.stopActions = [];\n\n        self.flagNode = null;\n\n    \n        //开始游戏\n        self.startGame();\n\n        //移动的方向\n        self.disX = 0;\n        //鼠标按下是否移动的标志\n        self.touchFlag = 0;\n        //移动的前一个坐标\n        self.prePosX = 0;\n    },    \n\n    start: function(){\n        window.Global_thisNode = this;\n        this.flagCount = 0;\n        this.bodyIndex = 0;\n    },\n    //增加身体长度奖励\n    onGotBodyReward: function(count){\n        this.Hero.getComponent('hero').setHeroLength(count);\n        this.onAddBodyToLast(count);\n    },\n\n/**************hero start*********************/\n    initHero: function(){\n         this.Hero = cc.instantiate(this.HeroPrefab);\n         this.Hero.getComponent('hero').init(this);\n         this.Hero.parent = this.heroSprite;\n         this.Hero.setLocalZOrder(101);\n         this.Hero.setPosition(cc.p(0, cc.director.getWinSize().height/2 - 4*this.heroPosY - this.Hero.width/2));\n         this.Hero.active = false;\n               \n         this.beforHeroPosition = this.Hero.getPosition();\n    },\n\n    onTouchCallBack: function(){\n        this.touchFlag++;\n        if(this.touchFlag == 2){\n            this.Hero.getComponent('hero').onRecoveryRotation();\n            this.Hero.getComponent('hero').onSetHeroSpeed(cc.v2(0,window.Global_VelocityForY));\n            this.touchFlag = 0;\n        }\n    },\n\n    moveHero: function(self){\n        //开始点击\n        self.canvas.on(cc.Node.EventType.TOUCH_START, function(event){\n            //将鼠标按下后的第一个坐标位置存入数组\n            window.Global_moveTouchPosition.push(event.target.convertTouchToNodeSpaceAR(event.touch));\n            self.prePosX = event.target.convertTouchToNodeSpaceAR(event.touch).x;\n            //开启鼠标按下的定时器\n            if(!cc.director.getScheduler().isScheduled(self.onTouchCallBack, self)){\n                self.schedule(self.onTouchCallBack, 0.03);\n            }\n        }, self.node);\n\n        //鼠标移动 - 更新目地坐标\n        self.canvas.on(cc.Node.EventType.TOUCH_MOVE, function(event){\n            var s = 0;\n            window.Global_heroMoving = true;\n\n            \n            //坐标数组为空时加入当前touch坐标\n            if(window.Global_moveTouchPosition.length == 0){\n                window.Global_moveTouchPosition.push(event.target.convertTouchToNodeSpaceAR(event.touch));\n            }\n            //判断鼠标移动方向和碰撞方向的关系决定是否将移动坐标存入坐标数组\n            if(window.Global_isTurnLeftCrash){\n                var s = event.target.convertTouchToNodeSpaceAR(event.touch).x - window.Global_moveTouchPosition[0].x;\n                if(s > 0){\n                    window.Global_moveTouchPosition.push(event.target.convertTouchToNodeSpaceAR(event.touch));\n                }\n            }else if(window.Global_isTurnRightCrash){\n                s = event.target.convertTouchToNodeSpaceAR(event.touch).x - window.Global_moveTouchPosition[0].x;\n                if(s < 0){\n                    window.Global_moveTouchPosition.push(event.target.convertTouchToNodeSpaceAR(event.touch));\n                }\n            }else{\n                window.Global_moveTouchPosition.push(event.target.convertTouchToNodeSpaceAR(event.touch));\n            }\n            s = event.target.convertTouchToNodeSpaceAR(event.touch).x - window.Global_moveTouchPosition[0].x;\n            if(Math.abs(s) < 2){\n                window.Global_heroMoving = false;\n            }       \n            //依据数组中的坐标依次移动hero， 移动之后去除该坐标\n            if(window.Global_moveTouchPosition.length > 1){\n                s = window.Global_moveTouchPosition[1].x - window.Global_moveTouchPosition[0].x;\n                self.prePosX = window.Global_moveTouchPosition[0].x;\n                if(window.Global_isTurnLeftCrash){\n                    if(s < 0) return;\n                }else if(window.Global_isTurnRightCrash){\n                    if(s > 0) return;\n                }\n                if(Math.abs(s) < 1){\n                    //cc.log(\"-----------onSetHeroSpeed---\")\n                    self.Hero.getComponent('hero').onSetHeroSpeed(cc.v2(0,window.Global_VelocityForY));\n                }else{   \n                    //改变蛇头的角度\n                    //self.Hero.getComponent('hero').onChangeRotation(s);\n                }\n                window.Global_tttt.push(s);\n                self.disX = s; \n                window.Global_moveTouchPosition.shift();\n\n                //cc.log(Math.abs(s));\n                var flagDisX = Math.abs(s*32);\n                let multiple = 28;\n                if(flagDisX > 3 && flagDisX < 15){\n                    multiple = 29;\n                }else if(flagDisX < 30){\n                    multiple = 31;\n                }else{\n                    multiple = 32;\n                }\n\n                if(window.adsControl.canUseSdkbox()){\n                    var winSizeWidth = myNative.callNativeFun(\"NativeOcClass\", \"onGetWinSizeWisth\");\n                    if(winSizeWidth > 1300){\n                        multiple -= Math.floor(winSizeWidth/100);\n                    }\n                }\n\n                //设置力来移动\n                var distance = Math.abs(s*multiple);\n                var y = 0.1;\n                if(s < 0){\n                    y = -0.1;\n                }\n                var velocity = cc.v2(s*multiple, y);\n                velocity.normalizeSelf();\n                velocity.mulSelf(distance*2);\n                self.Hero.getComponent('hero').onSetHeroSpeed(velocity);\n\n                \n                self.disX = s;\n            }else{\n                self.disX = 0;\n            }\n            self.touchFlag = 0;\n        }, self.node);\n        //鼠标松开事件， 停止移动\n        self.canvas.on(cc.Node.EventType.TOUCH_END, function(event){\n            if(window.Global_moveTouchPosition.length > 0){\n                for(var i = 0; i < window.Global_moveTouchPosition.length;){\n                    var s = window.Global_moveTouchPosition[0].x - self.prePosX;\n                    //设置力来移动\n                    var distance = Math.abs(s*30);\n                    var y = 0.1;\n                    if(s < 0){\n                        y = -0.1;\n                    }\n                    var velocity = cc.v2(s*30, y);\n                    velocity.normalizeSelf();\n                    velocity.mulSelf(distance*2);\n                    self.Hero.getComponent('hero').onSetHeroSpeed(velocity);\n                    self.prePosX = window.Global_moveTouchPosition[0].x;\n                    window.Global_moveTouchPosition.shift();\n                }\n            }else{\n                self.Hero.getComponent('hero').onSetHeroSpeed(cc.v2(0,window.Global_VelocityForY));\n            }\n            //console.log(window.Global_moveTouchPosition.length);\n            window.Global_moveTouchPosition = [];\n            window.Global_heroMoving = false;\n            //关闭鼠标按下的定时器\n            if(cc.director.getScheduler().isScheduled(self.onTouchCallBack,self)){   \n                self.unschedule(self.onTouchCallBack);\n            }\n           \n        }, self.node);\n    },\n\n    onSetPosition: function(pos, isRightToLeft){\n        this.canMovePosition = this.Hero.parent.convertToNodeSpaceAR(pos);\n        if(isRightToLeft){\n            this.canMovePosition.x += this.Hero.width/2;\n        }else{\n            this.canMovePosition.x -= this.Hero.width/2;\n        }\n    },\n\n    onSetHeroPosition: function(num){\n        this.Hero.setPositionX(this.Hero.getPositionX() + num);\n    },\n\n    onGetHeroPosition: function(){\n        return this.Hero.getPosition();\n    },\n/************ hero end *************/\n\n/*****************body start******************/\n    //在最后一个位置添加count节长度\n    onAddBodyToLast: function(count){\n        var length = window.Global_heroBodyArr.length;\n        for( var i = 0; i < length; ++i){\n            window.Global_heroBodyArr[i].setLocalZOrder(99-i);\n        }\n        var len = window.Global_heroLength;\n        if(window.Global_heroLength < 30){\n                //hero本身的长度为0时， 在hero的位置添加\n                for(var i = 0; i < count; ++i){\n                    if(len == 0){\n                        var node = this.onAddBodyFromPool(i-1)\n                        //node.setPosition(cc.p(0, cc.director.getWinSize().height/2 - 4*this.heroPosY - this.Hero.width/2));\n                        window.Global_heroBodyArr.push(node);\n                        //console.log(node.getPosition());\n                        window.Global_heroBodyArr[len+i].setPosition(cc.p(0, cc.director.getWinSize().height/2 - 4*this.heroPosY - this.Hero.width/2));\n                    }else{\n                        var bodyLastPosition = window.Global_heroBodyArr[len - 1].getPosition();\n                        var node = this.onAddBodyFromPool(len+i);\n                        window.Global_heroBodyArr.push(node);\n                        window.Global_heroBodyArr[len+i].setPosition(cc.p(bodyLastPosition.x, bodyLastPosition.y));\n                    }\n                }\n            //身体跟着移动\n            window.Global_heroLength = window.Global_heroBodyArr.length;\n        }else{\n            //身体跟着移动\n            window.Global_heroLength += count;\n        }\n        if(len == 0){\n            window.Global_heroPositionsArray = [];\n        }\n        window.Global_oldHeroLength = window.Global_heroLength;\n    },\n    //添加body节点到场景\n    onAddBodyFromPool: function(index){\n        let body = null;\n        body = cc.instantiate(this.bodyPrefab);\n        body.parent = this.testSprite;\n        body.getComponent('bodyPrefab').init(index);\n        body.getComponent('bodyPrefab').onSetPreBodyIndex(index);\n        return body;\n    },\n    //开始游戏\n    startGame: function(){\n        window.shareForIntensify = false;\n        window.shareForDie = false;\n        window.noToShare = false;\n        window.Global_createPositionY = window.Global_createrSomethingY;\n\n        this.Hero.active = true;\n        //测试添加身体节点到场景\n        this.onAddBodyToLast(20);\n\n        if(window.isAgain){\n            this.startFlag = true;\n        }else{\n            this.startFlag = false;\n        }\n    },\n\n    lateUpdate:function(dt){\n        if(this.Hero.getPositionX() > cc.director.getWinSize().width/2 -this.Hero.width/2 || \n        this.Hero.getPositionX() < -cc.director.getWinSize().width/2 +this.Hero.width/2 ){\n            //改变蛇头的角度\n            this.Hero.getComponent('hero').onRecoveryRotation();\n        }\n        if(this.Hero.getPositionY() > this.positionY + 1 && this.Hero.getPositionY() < this.positionY + 20 ){   \n            window.Global_VelocityXNUM = 61.4;\n        }else if(this.Hero.getPositionY() < this.positionY -1 && this.Hero.getPositionY() > this.positionY - 5){     \n            window.Global_VelocityXNUM = 61.8;\n        }else if(this.Hero.getPositionY() <= this.positionY - 30){\n            window.Global_VelocityXNUM = 90;\n        }else if(this.Hero.getPositionY() >= this.positionY + 20){\n            window.Global_VelocityXNUM = 45;\n        }\n        window.Global_VelocityForY = (window.shareForCrash ? window.getCrashSpeed : window.Global_speed) * window.Global_VelocityXNUM;\n        if(this.disX == 0 || window.Global_moveTouchPosition.length < 1){\n            this.Hero.getComponent('hero').onSetHeroSpeed(cc.v2(0,window.Global_VelocityForY));\n        }\n    },\n    \n    update: function(dt) {\n        window.Global_VelocityXNUM = 61.5;\n        if(this.Hero.getPositionY() < this.positionY -10) return;\n    \n        this.heroSprite.y += window.Global_speed;\n        this.leftBodyNode.y += window.Global_speed;\n        this.rightBodyNode.y += window.Global_speed;\n        this.cameraNode.y += window.Global_speed;\n\n    },\n});\n"]}